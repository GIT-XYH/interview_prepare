这里面值得一提的就是ID-MAPPING（为用户生成和标识GUID），这个是这么回事：因为RTB请求日志中，数据来源于各类媒体，各类APP，这些记录中，没有统一的用户标识，有的数据中有imei码，有的有mac地址，有的有openudid，有的有androidid，，为了让后续的一些统计分析更加准确，需要为每一个用户生成一个全局统一标识；

这个问题我们当时研究和讨论了很久，也咨询过很多别的公司的做法，不过还是没有形成一个完美的方案；

最后我们的解决方案中，最核心的逻辑是用了spark graphx求最大连通子图来实现，通过连通子图找出用户各种标识（登录id、mac地址、imei码等）之间的关联性，从而识别出属于同一个用户的所有标识，从而据此生成一个GUID作为这个用户的全局唯一标识。并且在预处理中为每一条日志打上这个标识；
当然，这里面也不光是调用这个算法就能实现，还有很多额外的辅助逻辑，比如，如何在每天的计算中，让GUID保持延续性的问题等
（好好去准备GUID生成的详细逻辑，这里可以引导面试官再次问你GUID延续性保持方法的问题，你就可以继续跟他深入探讨）


附IDMAPPING整体流程
整体流程：
1.将当日数据中的所有用户标识字段，及标志字段之间的关联，生成点集合 、边集合
2.将上一日的ids->guid的映射关系，也生成点集合、边集合
3.将上面两类点集合、边集合合并到一起生成一个图
4.再对上述的图执行“最大连通子图”算法，得到一个连通子图结果
5.在从结果图中取到哪些id属于同一组，并生成一个唯一标识
6.将上面步骤生成的唯一标识去比对前日的ids->guid映射表（如果一个人已经存在guid，则沿用原来的guid）