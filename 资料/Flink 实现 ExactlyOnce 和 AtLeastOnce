1. 如果下级存储支持事务:
    Flink 可以通过实现两阶段提交和状态保存来实现端到端的一致性语义, 分为以下几个步骤:
        1. 开始事务, 创建一个临时文件夹, 把数据写入到这个临时文件夹中
        2. 预提交, 将内存中缓存的数据写入到文件并关闭
        3. 正式提交, 将之前写完的临时文件放入到目标目录下, 这代表着最终的数据会有一些延迟
        4. 丢弃, 丢弃临时文件
        5. 若失败发生在预提交成功后, 正式提交之前. 可以根据状态来提交预提交的数据局, 也可以删除预提交的数据

2. 下级存储不支持事务:
    具体实现是幂等写入, 需要下级存储具有幂等性写入特性